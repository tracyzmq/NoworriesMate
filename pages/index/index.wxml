<!-- 页面结构：包含标题、清单、生成按钮 -->
<view class="container">
  <!-- 标题区 -->
  <view class="header">
    <text class="title">今日功德簿</text>
    <text class="subtitle">(每日零点自动刷新)</text>
  </view>

  <!-- 反内耗清单区 -->
  <view class="list-container">
    <text class="list-title">请勾选你今天成功做到的“功德”：</text>
    <!-- 循环渲染清单项 -->
    <block wx:for="{{checklist}}" wx:key="id">
      <view class="list-item" bindtap="toggleCheck" data-index="{{index}}">
        <!-- 根据是否勾选显示不同图标 -->
        <image class="checkbox" src="{{item.checked ? iconChecked : iconUnchecked}}" mode="aspectFill"></image>
        <text class="item-text {{item.checked ? 'text-checked' : ''}}">{{item.text}}</text>
      </view>
    </block>
  </view>

  <!-- 行动按钮区 -->
  <view class="button-area">
    <button class="share-button" bindtap="generateImage" loading="{{loading}}">
      {{loading ? '生成中...' : '🔥 功德圆满，一键显圣 🔥'}}
    </button>
    <text class="hint">(生成后可保存并分享至朋友圈)</text>
  </view>

  <!-- 生成的图片预览区（默认隐藏） -->
  <view class="preview-area" wx:if="{{imagePath}}">
    <text class="preview-title">你的今日功德报告：</text>
    <image class="preview-image" src="{{imagePath}}" mode="widthFix"></image>
    <button class="save-button" bindtap="saveImage">💾 保存图片</button>
  </view>
</view>

<!-- 用于生成图片的画布，必须设置宽高且隐藏 -->
<canvas style="width:750px;height:1334px;position:fixed;top:100%;left:100%;" canvas-id="shareCanvas"></canvas>